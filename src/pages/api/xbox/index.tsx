import axios from "axios";
import { GetServerSideProps } from "next";
import { api } from "../../../services/api";


export default async function handler(req, res) {

    const response = await axios.get('https://redeem.microsoft.com/webblendredeem?lang=en-US&market=US&control=redeem&mock=false&metadata=mscomct&lang=en-US&cid=17a51a11c33b0f09&xhr=true&X-Requested-With=XMLHttpRequest&_=1619735620701', {
        headers: {
            Cookie: "MC1=GUID=f0731a20bd1c4a7ab7e37478560cf1d5&HASH=f073&LV=202104&V=4&LU=1617311531814; MUID=0A9FF8FF7FEC657E086AE8FA7E5A64CC; RPSShare=1; MSNRPSShare=1; me-ct=1; MSCOMRPSSecAuth=FADSBxRUzyIE6vaYt7Vsn1ezurwSQOtYJQNmAAAEgAAACG5DEG/v/oXHkAdKfKF%2BhWHRwgAA6%2BCX3BZYPLLoRvRZJRw%2B795vUCYTJYvaoMQvzS3x/rtCpB3RfAF22xiYb4IWlv8WPyGR07ooUt%2BZXLwONYVvipxM7VDqzc7nzy087DiQEDOftVqVZO3z1wMpZxlSmKLVieVaEbII3i895cfbsnHLPGyaQc5spCMAMEcBDDqCZkOtHa5JHc%2BaR33GUQE%2Bax2g6Plc0J7Y75paDpxDANSJz7Mud5wS0N6FkNPO/mUm7TJZESbsg%2Bx0n1Hibh6aytFdrdLdGl0/tZ2l7ynNmvWLkRM4567vccop7hoa5VINeIJCTAZDPSsw/dvTMNsa6OPLE5Y63DVy26EDcIuY2iuh2yeA4XVGMT/UUKEtwPUPFmVDIhNwGC7VMlTNGGXCTZFUhNwe6rpba83cDUe68vFD/ySlOH8FGOX1I%2BIY24Y0MVzpktDP0q1kKjg26GF3uixIQrWZNYEshtDBWQBlnP6Pu7ALqxjorjvicWIyhFC0d7%2BAe/Dg5kwdPdeNleagsHy0knWbzzRBVnw54QNE98VtITKAk2/mVxM2CKkrgDIe%2BzYIwf24GAMdke4tnNDv1JAzZ4yvu1MqZi8HRe0ze/1/fWCsHRPShFsO05FhrX42VU60KtohZXRIBTyaZILV9sjKKiHZjp3IAmt7wuQICmd8dwA%2BoRuhtHVI%2Bzv1FoSg8wMS9E8JXWpSgZLLFGJfKzYTizmS2pqjIezjEdOEgNQUfB44ddpbUT2akQ0IE2AvyKg6DJOIr6sTsEoxKCX%2B9D2JdtD0BuVmeNSUmrziPn8nvPuGxnii7sa45RGtAkYsEXhcxtyv/40GCW99DL%2Bc9LZY6En5SubZLUdwjFhXWmk2q4TcefMhCCpzj6UTVtszUiZK0I1LyPdmnD0AwC4kUc2gCiLSwyOR1g0B7/KoHZNjC6TsPMpQDT2YUyrhaDIivGtKY7sWQjifVgIzZAsoI/cDksKJXa5ecKEdno4PBCucWsB4kb8W1ab6AdIL/xlEDy7uH7fT61ovWZQE0f9gO7cgqBgjgENqVO7j0M2vF0d76r2LZFKJW1GjOqgzEAz61/0Um9CG6dhxnP3mWSvu7JlsT9QSJ8NFoD4QYPURgwFi%2B2iz1A0fcH995DB2V7VxUsZgcCFouax5j9yXSZ2MaN8TwoScP2V6zXlPiY4vv3HPKsVyk5OZ2hlWsh/4Pew0giAZ0QRYOeRjZzXHqqPc%2BKanKU1XReL/gUgm3QQ%2BcMBKQ3F/USFe9Oxrq%2BUVFrXV7BwEBcS8GPBvjK2sreznWmEq3eMfccdOPNB0XjrACofbUpMp/nWTkW3qSH18MbIfYQe%2BJ4Qd8yjWLWtfUjCN6NJvEhEjiXhSgeEWFh3XddXShZQEWoqILUdCXgFwrWcYYzI3GdhYSUKeQ21QvBQRVPhNA7TzfyIPnZV6bcckQoRS4utYoDsW5eXAHTYgT2Ih1lAnsvJnRLjS3WHxbQgRcCPUl3zLJj11ByQ1K8Zz//NuYdDPj0Q1kfhjG71i34Y3mwrKv7pmNmIlsRkaZVcN2hS2qNfi3mecoiRwjsM5V2lJ6jf6fWOJWTX9hO4auBmoOoB3dtBIkAyhvKYiOACjpKb358JVJoMhoEAeW37GNmxYnKMv%2BnJgqoI8XprsiXfl0aY4vt0SYL5U5IXvyNnahYZe/caQB0lBWgb5/giJiAMh5VWJv6yv8DsfEJQzejCDnzQnjWW8zC952%2Bzcp%2BlCFKz1E94i2WblskDlCp0BnE5Uem7A/YZM%2BRZ6Bqt2up/L11z0tpZcUbeUVc3fgBJrwlsIvpVNCnDZkEHZYbHmjD9tLj5d5AhPtEllVVPozDwnwVYA26%2BAvaiJbbkHtPA8F25ITfaZfKFX2XzVaXYTveFkejylZAsDjG2RCah5rmR6t6GH9uIzOe82kXN48EHe2wNEov52mnnBRCMNye0hYQOhe8vJBXDiZqYxDXP7ateKbdfHdXs0omeCoSdFcVRpSvsRIZZbT6adfqQ5E8gM5K2CcIGBCG9U%2BqzbO%2B7Kyru6xB7NF5HRUy%2BamhY/1qg5XtjkjVmLtc1drxgFwsCYZWULBLca4P%2BolX7DHCsoLdLpHEk4tI3G8vQr4m32l5Hv9N83Zqg4rWT36GYU%2BKMeXKjH3%2Bbuvg253JFtcHPuxlQGXLEJM38%2BctgAtA7XHYHGAuZx7KS7RIFoMLL7yDurFRg2fBL8dZIDdXy/2Ua7%2BfVSJsIUfaeb/9jaEPua7TNRy1N/OyW5NTJNiKCd4GAlHVzfodxJhRUildPi5hqNGCz5in6VlZEOW9%2BaHH4y1JqECiNWomzrLOUHgxnFuYSoZdBorUxKD08KOwEK6wuwcgG2ap%2BdGyv%2BQqzjrEFnTHv/rjY0wx%2B2YuwbPlz3/8TGmZ/lB5JU0x%2Bhw3T4%2BeqNqHE39xG41697C2TGPoOuh3pw9HmxoYN3dGCu28BLTR4CmoqhrWJ3dq%2Bzze64Ken0V%2BTZbxl/ZPssW/2Kfwax/df0NSGXVBC0ZjJVCDduyR9RbI3ws9w7ypfhD5Z1UVbXnZnuPvCQ00sTmEpep9653hglq%2BUyprIoqieUFABzT/thc7H1PuPXnfsf/pYiV/kSFg%3D%3D; MSPAuth=2quBTJ5n3G!1VMXdJGwnpTilY7nMjN**B!CKVb4WBjZfqyLFXFgBEnxqtPBiMH9ygNYq*WeqmMjHuYbMYmw*A5HPUd79SnjCaLEJ6TbL7DFDSU7pkz8!hkEs55ENrKwj38Q8fsB86!eMws3rugjSz11!ngPilJnpV0; MSPProf=2eW*7hlxzHZXexmRI6DyQqpbNmznSNEauQ2KqH*aUv*sVWMNwHQU9SRttFSjizYs*BS6udx*552ChXVZdvne!qz6AVQkKkKqlBrJshpVC7pAl7U*oW1Eysjbrszl2zCZdBy1RJ17YubujJjFCK3wjplFue1dPdbe*Pm3qgPUhXetTrtC02UnKEvg6laEArzO7RRkCehNP2r1JrbQVi*Nwb2MpcMeREfi8wd2UdoS7eJXjhKAcgJx5jCQ$$; ANON=A=552D7A3FFCA3E6B9903A190DFFFFFFFF&E=196c&W=2; NAP=V=1.9&E=1912&C=9UESpKFYfL7MRgeL3K3JR12kIb52JDfmmnbzQRDyRZT0T2MRzu7LYA&W=2; ASP.NET_SessionId=zw3suildkczkilpsnack04zz; InsiderGroups=17a51a11c33b0f09-; ANON=A=CAAF345D8AE8E86C46311BFBFFFFFFFF&E=196c&W=2; NAP=V=1.9&E=1912&C=9UESpKFYfL7MRgeL3K3JR12kIb52JDfmmnbzQRDyRZT0T2MRzu7LYA&W=2; MS0=fa43fe5aefe245b5b2f1d814eb513ecf; MS-CV=b1oehRav9UGoxgbA.1.0"
        }
    }).then((response) => {
        return response.data.metadata.mscomct;
    })

    if (req.method === 'POST') {
        res.status(200).json({'Authorization': response})
    } else {
        response.setHeader('Allow', 'POST');
        response.status(405).end('Method not allowed')
    }
}